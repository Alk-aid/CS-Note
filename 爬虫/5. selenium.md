# selenium

## 环境配置

1. 

```
pip install selenium
```

2. 下载浏览器的驱动程序

```

```

## 使用

https://www.cnblogs.com/becks/p/11878508.html

- 发起请求：get(url)
- 标签定位：find系列的方法
- 标签交互：send_keys('xxx')
- 执行js程序：excute_script('jsCode')
- 前进，后退：back(),forward()
- 关闭浏览器：quit()

```python
from selenium import webdriver
from lxml import etree
from time import sleep
#实例化浏览器对象
browser=webdriver.Edge(executable_path='./msedgedriver.exe')

#让浏览器发起一个指定url请求
browser.get('https://www.taobao.com/')
    
#输入内容
search_input=browser.find_element_by_id('q')
search_input.send_keys('iPhone')

#滚轮拖动
browser.execute_script('window.scroll(0,document.body.scrollHeight)')
sleep(5)

#点击按钮
botton=browser.find_element_by_class_name('btn-search')
botton.click()

#回退
browser.back()
#前进
browser.forward()
sleep(5)
browser.quit()
```

###  selenium处理iframe

​        - 如果定位的标签存在于iframe标签之中，则必须使用switch_to.frame(id)

###  动作链（拖动）：

#### 导包

```
from selenium.webdriver import ActionChains
```

   - 实例化一个动作链对象：action = ActionChains(bro)
   - click_and_hold（div）：长按且点击操作
   - move_by_offset(x,y)
   - perform()让动作链立即执行
   - action.release()释放动作链对象

### 无可视化界面以及规避检测

```python
from selenium import webdriver
from time import sleep
#实现无可视化界面
from selenium.webdriver.chrome.options import Options
#实现规避检测
from selenium.webdriver import ChromeOptions

#实现无可视化界面的操作
chrome_options = Options()
chrome_options.add_argument('--headless')
chrome_options.add_argument('--disable-gpu')

#实现规避检测
option = ChromeOptions()
option.add_experimental_option('excludeSwitches', ['enable-automation'])

#如何实现让selenium规避被检测到的风险
bro = webdriver.Chrome(executable_path='./chromedriver',chrome_options=chrome_options,options=option)

#无可视化界面（无头浏览器） phantomJs
bro.get('https://www.baidu.com')

print(bro.page_source)
sleep(2)
bro.quit()
```

