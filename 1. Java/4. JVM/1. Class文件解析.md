# 1. Class文件的介绍

- 一个Class文件对应一个类或者接口的信息
- Class文件是以字节为单位的二进制流；结构为无符号数 和 表；无符号数有u1，u2，u4，u8，用来描述 数字，引用，文本
- 字面量： 文本字符串 和 final常量
- 符号引用：类和接口的全限定名，字段的名词和描述符，方法的名词和描述符
- 描述符：用描述符来描述方法时，按照**先参数列表，后返回值**的顺序描述，参数列表按照参数的严格顺序放在一组小括号“()”之内。

# 2. Class文件的结构

Class 文件的总体结构如下：

1. 魔数：用来确定这个文件是否为一个能被虚拟机接受的有效合法的 Class 文件
2. Class 文件版本: 副版本号 和 主版本号
3. 常量池：常量池计数器(从1开始，0表示不引用任何一个常量池项目。) 和 常量池表(存放字面量 和 符号引用)；
4. 访问标志: public,final,super,interface,abstractannotation,enum,synthetic
5. 类索引、父类索引、接口索引集合
6. 字段表集合: 字段描述符，数据类型，名称
7. 方法表集合：
8. 属性表集合：

# 3. 使用 javap 指令解析 Class 文件

## 3.1 javac

1. javac xx.java
2. javac -g xx.java

> 第二个可以显示如本地变量表、指令和代码行偏移量映射表、常量池中方法的参数名称等等

## 3.2 javap

javap 的用法格式：javap <options> <classes>

```
  -help  --help  -?        输出此用法消息
  -version                 版本信息
  -v  -verbose             输出附加信息
  -l                       输出行号和本地变量表
  -public                  仅显示公共类和成员
  -protected               显示受保护的/公共类和成员
  -package                 显示程序包/受保护的/公共类
                           和成员 (默认)
  -p  -private             显示所有类和成员
  -c                       对代码进行反汇编
  -s                       输出内部类型签名
  -sysinfo                 显示正在处理的类的
                           系统信息 (路径, 大小, 日期, MD5 散列)
  -constants               显示最终常量
  -classpath <path>        指定查找用户类文件的位置
  -cp <path>               指定查找用户类文件的位置
  -bootclasspath <path>    覆盖引导类文件的位置
```

一般常用的是 -v -p -c 三个选项：

- javap -p 显示所有类和成员

- javap -c 会对当前 Class 字节码进行反编译生成汇编代码

- javap -v classxx 除了包含 -c 内容外，还会输出行号、局部变量表信息、常量池等信息
