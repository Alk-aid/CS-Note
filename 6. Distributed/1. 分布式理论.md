# 1. CAP & BASE

## 1.1 CAP

CAP是consistent(一致性)， Availability(可用性)，Partition tolerance(分区容忍性)的总称

- Consistency（一致性）：用户访问分布式系统中的任意节点，得到的数据必须一致。
- Availability （可用性）：用户访问集群中的任意健康节点，必须能得到响应，而不是超时或拒绝。
- Partition（分区）：因为网络故障或其它原因导致分布式系统中的部分节点与其它节点失去连接，形成独立分区。
- Tolerance（容错）：在集群出现分区时，整个系统也要持续对外提供服务。

CAP难以同时满足，只能由CP 或者 AP模式

- 分布式系统节点通过网络连接，必然有网络断开的风险，一定会出现分区问题（P）
- 当分区出现时，系统的一致性（C）和可用性（A）就无法同时满足

## 1.2 BASE理论

BASE理论是对CAP的一种解决思路（AP方案的补充），包含三个思想：

- `Basically Available （基本可用）`：分布式系统在出现故障时，允许损失部分可用性，即保证核心可用。
  - **响应时间上的损失**: 正常情况下，处理用户请求需要 0.5s 返回结果，但是由于系统出现故障，处理用户请求的时间变为3s 
  - **系统功能上的损失**：正常情况，用户可以使用系统全部功能,但是由于系统访问量突然剧增,系统的部分非核心功能无法使用。

- `Soft State（软状态）`：**在一定时间内，允许出现中间状态，比如临时的不一致状态。**

- `Eventually Consistent（最终一致性）`：虽然无法保证强一致性，但是在软状态结束后，最终达到数据一致。

> Redis的主从数据就是异步的，因此不满足强一致性，；而是保证最终一致性

最终一致性的实现方案

- **读时修复** : 在读取数据时，检测数据的不一致，进行修复。
- **写时修复** : 在写入数据，检测数据的不一致时，进行修复。
- **异步修复** : 这个是最常用的方式，通过定时对账检测副本数据的一致性，并修复。

# 2. Paxos & Raft

# 3. 分布式ID

# 4. 分布式事务

# 5. rpc

# 6. 分布式协调
