# 1. Language Processors

## 1.1 Compiler And Interperter

- `Compiler`: 
  
  - a program that can translate a program in one language into another language。
  - an important role of the compiler is to report any error during the translation process
  
  ![image-20220308104251857](http://aikaid-img.oss-cn-shanghai.aliyuncs.com/img/image-20220308104251857.png)
  
- `Interpreter`:
  
  - directly execute the operations specified in the source program
  - source program 和 input 通过 interpreter 产生 output
  
  ![image-20220308104311597](http://aikaid-img.oss-cn-shanghai.aliyuncs.com/img/image-20220308104311597.png)
  
- `Comparison`
  - `Compiler` faster than `interpreter` at mapping inputs to outputs
  - `Intepreter` give better error diagnostics than a compiler，because it executes the source program statement by statement

## 1.2 程序的生命周期

将源文件转化为`可执行目标文件`的命令

```shell
gcc -o <target_file_name> <source_file_name>
gcc -o hello hello.c
```

1. 预处理，Using `preprocessor`

- .c文件 -> .i文件
- 宏的展开，删除注释，引入头文件(#include),处理所有的条件编译指令(#if,#iddef)
- 源文件可能会被分割为多个模块，预处理器负责整合这些模块成一个文件

2. 编译，Using `Compiler`

- .i文件 -> .s文件；
- 主要处理是： 词法分析，语法分析，语义分析，以及进行优化后生成相应的汇编代码

3. 汇编，Using `Assembler`

- .s 文件 -> .o文件；从汇编文件转化为二进制机器码文件（`可重定位目标程序`,relocatable object program）

4. 链接，Using `Linker`

- 在程序中可能调用了某个库文件中的函数等问题需要链接来解决, 将有关的目标文件彼此相连接，使得所有的这些目标文件成为一个能够被操作系统装入执行的统一整体, 也就是`可执行文件`

![image-20220109133520360](http://aikaid-img.oss-cn-shanghai.aliyuncs.com/img/image-20220109133520360.png)

# 2. The Structure Of a Compiler

A compilers maps a source program into a target program. there are two parts to this mapping

- `analysis(the front end):`:

  - breaks up the source program into constituent pieces(组成要素) and imposes a grammatical structure on them. Use this structure to created `an intermediate representation` of the source program
  - collects information about the source program and stores it in a data structure called a `symbol table`

- `synthesis(the back end):`

  - constructs the target program from the intermediate representation and the information in the symbol table.

  ![image-20220308151027280](http://aikaid-img.oss-cn-shanghai.aliyuncs.com/img/image-20220308151027280.png)

![image-20220308155025057](http://aikaid-img.oss-cn-shanghai.aliyuncs.com/img/image-20220308155025057.png)

## 2.1 Lexical Analysis(scanning)

1. groups the characters into meaningful sequences called `lexemes`
2. For each `lexeme`, the lexical analyzer produces a token of the form as output

​							$$ <token-name, arrtibute-value>$$

example:

```java
position = intitial + rate * 60
```

其中

- postion是一个 lexeme，被映射为 一个 token `<id, 1>`
- = 是一个lexeme，被映射为 一个token `<=>`

经过lexical analyzer以后被映射为 the sequence of token

​			$$ <id, 1> <=> <id,2> <+> <id,3> <*> <60>$$

## 2.2 Syntax Analysis(parsing)

1. The parser uses the first components of the tokens produced by the lexical analyzer to create
   `a tree-like intermediate representation ` that depicts the grammatical structure of the token stream.

2. each interior node represents an operation
3. the children of the node represent the arguments of the operation.

## 2.3 Semantic Analysis

1. uses the syntax tree and the information in the symbol table to check the source program for semantic consistency with the language definition.

- for example, `type checking`。 like each operator has matching operands.
- The language specication may permit some type conversions called coercions（自动类型转换）

2. It also gathers type information and saves it in either the syntax tree or the symbol table, for subsequent use during intermediate-code generation.

## 2.4 Intermediate Code Generation

1. Syntax trees are a form of intermediate representation。they are commonly used during syntax and semantic analysis.

2. After syntax and semantic analysis of the source program, many compilers generate an explicit low-level or machine-like intermediate representation,which we can think of as a program for an abstract machine.

## 2.5 Code Optimization

...

## 2.6 Code Generation

The code generator takes as input an intermediate representation of the source program and maps it into the target language.

## 2.7 Symbol-Table Management

`The symbol table` is a data structure containing a record for each variable name, with fields for the attributes of the name. 

