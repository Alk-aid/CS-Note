# 1. Language Processors

## 1.1 Compiler And Interperter

- `Compiler`: 
  
  - 编译器是一个将一种语言翻译为另一种语言的程序
  - 编译器的一个重要作用是报告翻译阶段的错误
  
  ![image-20220308104251857](http://aikaid-img.oss-cn-shanghai.aliyuncs.com/img/image-20220308104251857.png)
  
- `Interpreter`:
  
  - 直接利用用户提供的input执行源程序中的指定的操作
  - source program 和 input 通过 interpreter 产生 output
  
  ![image-20220308104311597](http://aikaid-img.oss-cn-shanghai.aliyuncs.com/img/image-20220308104311597.png)
  
- `Comparison`
  - 解释程序不产生目标代码
  - 在将input转化为output中，编译器比解释器快
  - 解释器的错误诊断效果比编译器好

## 1.2 The life Cycle Of A program

将源文件转化为`可执行目标文件`的命令

```shell
gcc -o <target_file_name> <source_file_name>
gcc -o hello hello.c
```

1. 预处理，Using `preprocessor`

- .c文件 -> .i文件
- 宏的展开，删除注释，引入头文件(#include),处理所有的条件编译指令(#if,#iddef)
- 源文件可能会被分割为多个模块，预处理器负责整合这些模块成一个文件

2. 编译，Using `Compiler`

- .i文件 -> .s文件；
- 主要处理是： 词法分析，语法分析，语义分析，以及进行优化后生成相应的汇编代码

3. 汇编，Using `Assembler`

- .s 文件 -> .o文件；从汇编文件转化为二进制机器码文件（`可重定位目标程序`,relocatable object program）

4. 链接，Using `Linker`

- 在程序中可能调用了某个库文件中的函数等问题需要链接来解决, 将有关的目标文件彼此相连接，使得所有的这些目标文件成为一个能够被操作系统装入执行的统一整体, 也就是`可执行文件`

![image-20220109133520360](http://aikaid-img.oss-cn-shanghai.aliyuncs.com/img/image-20220109133520360.png)

# 2. The Structure Of a Compiler

编译器可以将源程序转化为目标程序，这个映射过程由两部分组成

- `analysis(the front end):`:

  - 把源程序分解为多个组成要素，然后在这些组成要素之上加上语法结构，然后利用这个语法结构创建源程序的一个中间表示
  - 如果分析部分检查出源程序没有按照正确的语法结构或者语义不一致，那么就必须提供有用的信息，使得用户可以矫正
  - 收集有关源程序的信息，并把这些信息放在一个`符号表`(symbol table)`

- `synthesis(the back end):` 

  - 根据 中间表示 和 符号表创建目标程序

  ![image-20220308151027280](http://aikaid-img.oss-cn-shanghai.aliyuncs.com/img/image-20220308151027280.png)

![image-20220308155025057](http://aikaid-img.oss-cn-shanghai.aliyuncs.com/img/image-20220308155025057.png)

## 2.2 Syntax Analysis(parsing)

1. 语法分析使用词法分析产生的token的第一分量(`token- name`)来创建树形的中间表示(`syntax tree`)，token的第二个分量则用于语义分析 和 代码生成步骤使用
2. 这个中间表示给出了token流的语法结构, 树中的每个内节点表示一个运算，内结点的子节点表示the arguments of the operation.

## 2.3 Semantic Analysis

1. 使用语法树和符号表来检查语义

- 例如，`type checking`，比如检查每个运算含有对应的operands；或者要求数组的下标是整数
- 允许进行自动类型转换

2. 同时也收集类型信息放到语法树或者符号表中，便于后续中间代码生成使用

## 2.4 Intermediate Code Generation

1. Syntax trees are a form of intermediate representation。they are commonly used during syntax and semantic analysis.

2. After syntax and semantic analysis of the source program, many compilers generate an explicit low-level or machine-like intermediate representation,which we can think of as a program for an abstract machine.

## 2.5 Code Optimization

...

## 2.6 Code Generation

代码生成器以源程序的中间表示作为输入，映射为目标语言

## 2.7 Symbol-Table Management

符号表的每个record，记录变量的名字和对应的熟悉

